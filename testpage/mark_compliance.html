<!DOCTYPE html>
<html lang="en">
<head>
    <title>Mark Element Compliance Test (WHATWG 4.5.23)</title>
    <meta charset="UTF-8">
    <style>
        .pass { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
        .info { color: blue; }
        .test-box { border: 1px solid #ccc; margin: 10px 0; padding: 10px; }
    </style>
</head>
<body>
    <h1>Mark Element Compliance Test (WHATWG 4.5.23)</h1>

    <div id="results"></div>

    <h2>Visual Tests</h2>

    <h3>Test 1: Basic Highlight</h3>
    <div class="test-box">
        <p id="test1"><mark>This text should be highlighted</mark></p>
    </div>
    <p>Expected: Text with yellow background and black text</p>

    <h3>Test 2: Search Result Highlight (Spec Example)</h3>
    <div class="test-box">
        <p id="test2">I also have some <mark>kitten</mark>s who are visiting me
        these days. They're really cute. I think they like my garden! Maybe I
        should adopt a <mark>kitten</mark>.</p>
    </div>
    <p>Expected: Both "kitten" words highlighted with yellow background</p>

    <h3>Test 3: Highlight in Quotation (Spec Example)</h3>
    <div class="test-box">
        <p lang="en-US">Consider the following quote:</p>
        <blockquote lang="en-GB">
            <p id="test3">Look around and you will find, no-one's really
            <mark>colour</mark> blind.</p>
        </blockquote>
    </div>
    <p>Expected: "colour" highlighted within blockquote</p>

    <h3>Test 4: Inline with Other Text</h3>
    <div class="test-box">
        <p id="test4">The <mark>highlighted part</mark> is important.</p>
    </div>
    <p>Expected: Only "highlighted part" has yellow background</p>

    <h3>Test 5: Nested Inside Other Elements</h3>
    <div class="test-box">
        <p id="test5"><strong><mark>Bold and highlighted</mark></strong></p>
    </div>
    <p>Expected: Text is both bold AND highlighted</p>

    <h3>Test 6: Mark with Link Inside</h3>
    <div class="test-box">
        <p id="test6"><mark>Check our <a href="#">website</a> for details</mark></p>
    </div>
    <p>Expected: Entire text including link has yellow background</p>

    <h3>Test 7: Multiple Mark Elements</h3>
    <div class="test-box">
        <p id="test7">
            <mark>First highlight</mark> normal text <mark>second highlight</mark>
        </p>
    </div>
    <p>Expected: Two separate highlighted sections with normal text between</p>

    <h3>Test 8: Empty Mark Element</h3>
    <div class="test-box">
        <p id="test8">Before<mark></mark>After</p>
    </div>
    <p>Expected: "BeforeAfter" with no visible highlight (empty element)</p>

    <h3>Test 9: Mark vs Strong Distinction (Spec Example)</h3>
    <div class="test-box">
        <p><mark>A wormhole can be held open for just under 39 minutes.</mark></p>
        <p><strong>Warning: The vortex will annihilate anything in its path.</strong></p>
    </div>
    <p>Expected: First paragraph highlighted (relevant), second bold (important)</p>

    <h3>Test 10: Mark Inside Pre/Code</h3>
    <div class="test-box">
        <pre><code>var i: Integer;
begin
   i := <mark>1.1</mark>;
end.</code></pre>
    </div>
    <p>Expected: "1.1" highlighted within preformatted code block</p>

    <hr>

    <h2>JavaScript Tests</h2>

    <script>
        var results = document.getElementById('results');

        function assert(condition, message) {
            var p = document.createElement('p');
            if (condition) {
                p.innerHTML = "PASS: " + message;
                p.classList.add('pass');
            } else {
                p.innerHTML = "FAIL: " + message;
                p.classList.add('fail');
            }
            results.appendChild(p);
        }

        function info(message) {
            var p = document.createElement('p');
            p.innerHTML = "INFO: " + message;
            p.classList.add('info');
            results.appendChild(p);
        }

        function findChildByTag(parent, tagName) {
            if (!parent || !parent.children) return null;
            tagName = tagName.toUpperCase();
            for (var i = 0; i < parent.children.length; i++) {
                if (parent.children[i].tagName === tagName) {
                    return parent.children[i];
                }
            }
            return null;
        }

        function countChildrenByTag(parent, tagName) {
            if (!parent || !parent.children) return 0;
            tagName = tagName.toUpperCase();
            var count = 0;
            for (var i = 0; i < parent.children.length; i++) {
                if (parent.children[i].tagName === tagName) {
                    count++;
                }
            }
            return count;
        }

        // Test 1: Find mark element via children
        var test1 = document.getElementById('test1');
        var markElement = findChildByTag(test1, 'mark');
        assert(markElement !== null, "Mark element found via children");

        // Test 2: tagName is MARK
        if (markElement) {
            assert(markElement.tagName === "MARK",
                "tagName is 'MARK' (was: '" + markElement.tagName + "')");
        }

        // Test 3: textContent works
        if (markElement) {
            var content = markElement.textContent;
            assert(content === "This text should be highlighted",
                "textContent returns correct value");
        }

        // Test 4: innerHTML works
        if (markElement) {
            var html = markElement.innerHTML;
            assert(typeof html === 'string' && html.length > 0,
                "innerHTML returns content (length: " + html.length + ")");
        }

        // Test 5: Can contain phrasing content (link)
        var test6 = document.getElementById('test6');
        if (test6) {
            var markWithLink = findChildByTag(test6, 'mark');
            var hasLink = markWithLink && findChildByTag(markWithLink, 'a') !== null;
            assert(hasLink, "Mark element can contain anchor elements");
        }

        // Test 6: Multiple mark elements work independently
        var test7 = document.getElementById('test7');
        if (test7) {
            var markCount = countChildrenByTag(test7, 'mark');
            assert(markCount === 2,
                "Multiple mark elements found (count: " + markCount + ")");
        }

        // Test 7: Uses HTMLElement (no special interface)
        if (markElement) {
            assert(typeof markElement.id !== 'undefined',
                "Mark element has HTMLElement properties (id)");
            assert(typeof markElement.textContent !== 'undefined',
                "Mark element has HTMLElement properties (textContent)");
        }

        // Test 8: Mark element is inline (phrasing content)
        var test4 = document.getElementById('test4');
        if (test4) {
            var text = test4.textContent;
            assert(text.indexOf("highlighted part") !== -1,
                "Mark renders inline within paragraph");
        }

        info("Visual tests above should be verified manually");
        info("Check: yellow background (#ffff00) and black text on mark elements");
    </script>

    <hr>
    <p><a href="index.html">Back to Index</a></p>
</body>
</html>
